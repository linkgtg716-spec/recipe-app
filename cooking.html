<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çƒ¹é¥ªæ¨¡å¼ - Cooking Mode</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* çƒ¹é¥ªæ¨¡å¼ç‰¹å®šæ ·å¼ */
        .cooking-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        .cooking-header {
            background-color: #fff;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            text-align: center;
        }

        .cooking-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .current-step-container {
            background-color: #fff;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            text-align: center;
        }

        .step-number {
            display: inline-block;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ff9800 0%, #ff6b00 100%);
            color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0 auto 1rem;
        }

        .current-step-text {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        .timer-container {
            background-color: #f8f8f8;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .timer-display {
            font-size: 3rem;
            font-weight: 700;
            color: #ff9800;
            text-align: center;
            margin-bottom: 1rem;
        }

        .timer-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .timer-btn {
            background-color: #fff;
            border: 2px solid #ff9800;
            color: #ff9800;
            border-radius: 8px;
            padding: 0.6rem 1.5rem;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .timer-btn:hover {
            background-color: #ff9800;
            color: #fff;
        }

        .navigation-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .nav-btn {
            background-color: #fff;
            border: 2px solid #ddd;
            border-radius: 12px;
            padding: 0.8rem 2rem;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            border-color: #ff9800;
            background-color: #fff8f0;
        }

        .nav-btn.primary {
            background: linear-gradient(135deg, #ff9800 0%, #ff6b00 100%);
            color: #fff;
            border: none;
        }

        .nav-btn.primary:hover {
            background: linear-gradient(135deg, #ff6b00 0%, #ff9800 100%);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .back-btn {
            background-color: #fff;
            border: 2px solid #ddd;
            border-radius: 12px;
            padding: 0.6rem 1.5rem;
            font-size: 0.9rem;
            cursor: pointer;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            border-color: #666;
            background-color: #f5f5f5;
        }

        @media (max-width: 600px) {
            .cooking-container {
                padding: 1rem;
            }

            .current-step-text {
                font-size: 1.1rem;
            }

            .timer-display {
                font-size: 2.5rem;
            }

            .navigation-buttons {
                flex-direction: column;
            }

            .nav-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <h1 class="nav-logo">ğŸ³ çƒ¹é¥ªæ¨¡å¼</h1>
        </div>
    </nav>

    <!-- ä¸»å†…å®¹åŒº -->
    <main class="cooking-container">
        <button class="back-btn" onclick="window.location.href='index.html'">â† è¿”å›é£Ÿè°±</button>

        <div class="cooking-header">
            <h2 id="cooking-title" class="cooking-title">åŠ è½½ä¸­...</h2>
        </div>

        <div class="current-step-container">
            <div class="step-number" id="step-number">1</div>
            <div class="current-step-text" id="current-step-text">å‡†å¤‡å¼€å§‹...</div>
            
            <div class="timer-container" id="timer-container" style="display: none;">
                <div class="timer-display" id="timer-display">00:00</div>
                <div class="timer-controls">
                    <button class="timer-btn" id="start-timer-btn">å¼€å§‹</button>
                    <button class="timer-btn" id="pause-timer-btn" style="display: none;">æš‚åœ</button>
                    <button class="timer-btn" id="reset-timer-btn">é‡ç½®</button>
                </div>
            </div>
        </div>

        <div class="navigation-buttons">
            <button class="nav-btn" id="prev-step-btn" disabled>ä¸Šä¸€æ­¥</button>
            <button class="nav-btn primary" id="next-step-btn">ä¸‹ä¸€æ­¥</button>
        </div>
    </main>

    <script>
        let currentRecipe = null;
        let currentStepIndex = 0;
        let timerInterval = null;
        let timerSeconds = 0;
        let isTimerRunning = false;

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadRecipe();
            initNavigation();
            initTimer();
        });

        // ä» localStorage åŠ è½½é£Ÿè°±
        function loadRecipe() {
            const savedRecipe = localStorage.getItem('currentRecipe');
            if (savedRecipe) {
                currentRecipe = JSON.parse(savedRecipe);
                document.getElementById('cooking-title').textContent = currentRecipe.title;
                showStep(0);
            } else {
                document.getElementById('cooking-title').textContent = 'æœªæ‰¾åˆ°é£Ÿè°±';
                document.getElementById('current-step-text').textContent = 'è¯·å…ˆé€‰æ‹©é£Ÿè°±';
            }
        }

        // æ˜¾ç¤ºå½“å‰æ­¥éª¤
        function showStep(index) {
            if (!currentRecipe || !currentRecipe.steps || index < 0 || index >= currentRecipe.steps.length) {
                return;
            }

            currentStepIndex = index;
            const step = currentRecipe.steps[index];
            
            document.getElementById('step-number').textContent = step.step;
            document.getElementById('current-step-text').textContent = step.text;

            // æ˜¾ç¤º/éšè—è®¡æ—¶å™¨
            const timerContainer = document.getElementById('timer-container');
            if (step.duration) {
                timerContainer.style.display = 'block';
                const durationMatch = step.duration.match(/(\d+)\s*min/);
                if (durationMatch) {
                    timerSeconds = parseInt(durationMatch[1]) * 60;
                    updateTimerDisplay();
                }
            } else {
                timerContainer.style.display = 'none';
            }

            // æ›´æ–°å¯¼èˆªæŒ‰é’®çŠ¶æ€
            document.getElementById('prev-step-btn').disabled = index === 0;
            document.getElementById('next-step-btn').textContent = 
                index === currentRecipe.steps.length - 1 ? 'å®Œæˆ' : 'ä¸‹ä¸€æ­¥';
        }

        // åˆå§‹åŒ–å¯¼èˆª
        function initNavigation() {
            document.getElementById('prev-step-btn').addEventListener('click', function() {
                if (currentStepIndex > 0) {
                    showStep(currentStepIndex - 1);
                }
            });

            document.getElementById('next-step-btn').addEventListener('click', function() {
                if (currentStepIndex < currentRecipe.steps.length - 1) {
                    showStep(currentStepIndex + 1);
                } else {
                    // å®Œæˆæ‰€æœ‰æ­¥éª¤
                    alert('æ­å–œï¼æ‚¨å·²å®Œæˆæ‰€æœ‰æ­¥éª¤ï¼ğŸ‰');
                    window.location.href = 'index.html';
                }
            });
        }

        // åˆå§‹åŒ–è®¡æ—¶å™¨
        function initTimer() {
            const startBtn = document.getElementById('start-timer-btn');
            const pauseBtn = document.getElementById('pause-timer-btn');
            const resetBtn = document.getElementById('reset-timer-btn');

            startBtn.addEventListener('click', function() {
                if (!isTimerRunning) {
                    isTimerRunning = true;
                    startBtn.style.display = 'none';
                    pauseBtn.style.display = 'inline-block';
                    
                    timerInterval = setInterval(function() {
                        if (timerSeconds > 0) {
                            timerSeconds--;
                            updateTimerDisplay();
                            
                            // æ—¶é—´åˆ°
                            if (timerSeconds === 0) {
                                clearInterval(timerInterval);
                                isTimerRunning = false;
                                startBtn.style.display = 'inline-block';
                                pauseBtn.style.display = 'none';
                                alert('â° æ—¶é—´åˆ°ï¼');
                            }
                        }
                    }, 1000);
                }
            });

            pauseBtn.addEventListener('click', function() {
                if (isTimerRunning) {
                    clearInterval(timerInterval);
                    isTimerRunning = false;
                    startBtn.style.display = 'inline-block';
                    pauseBtn.style.display = 'none';
                }
            });

            resetBtn.addEventListener('click', function() {
                clearInterval(timerInterval);
                isTimerRunning = false;
                startBtn.style.display = 'inline-block';
                pauseBtn.style.display = 'none';
                
                // é‡æ–°è·å–å½“å‰æ­¥éª¤çš„æ—¶é•¿
                const step = currentRecipe.steps[currentStepIndex];
                if (step.duration) {
                    const durationMatch = step.duration.match(/(\d+)\s*min/);
                    if (durationMatch) {
                        timerSeconds = parseInt(durationMatch[1]) * 60;
                        updateTimerDisplay();
                    }
                }
            });
        }

        // æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
        function updateTimerDisplay() {
            const minutes = Math.floor(timerSeconds / 60);
            const seconds = timerSeconds % 60;
            document.getElementById('timer-display').textContent = 
                `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }
    </script>
</body>
</html>

